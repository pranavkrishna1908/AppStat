---
title: "Untitled"
output: html_document
date: "2023-03-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
str(Data)
library(MASS)
library(car)
library(pROC)
library(tidyverse)
library(forcats)
library(janitor)
original_data = Data
Data$OperatingSystems = as.factor(Data$OperatingSystems)
Data$Browser = as.factor(Data$Browser)
Data$Region = as.factor(Data$Region)
Data$TrafficType = as.factor(Data$TrafficType)
Data = clean_names(Data)
c_names = colnames(Data)
c_names[1] = 'n_admin'
c_names[2] = 'time_admin'
c_names[3] = 'n_info'
c_names[4] = 'time_info'
c_names[18] = 'purchase'
colnames(Data) = c_names
Data$browser = fct_collapse(Data$browser, Other = c('3','6','7','8','9','10','11','12','13'))
Data$operating_systems = fct_collapse(Data$operating_systems, Other = c('5','6', '7','8'))
y =  Data$purchase


ggplot()+
  geom_density(aes(x = Data$product_related_duration[which(Data$product_related_duration <110)],col = y[which(   Data$product_related_duration <110)]))


ggplot()+
  geom_density(aes(x = Data$time_admin[which(Data$time_admin<1100)],col = y[which(Data$time_admin<1100)]))


ggplot()+
  geom_density(aes(x = Data$time_info,col = y))


ggplot()+
  geom_density(aes(x = Data$special_day[which(Data$special_day>0)], col = y[which(Data$special_day>0)]))



ggplot()+
  geom_density(aes(x = Data$exit_rates, col = y))
ggplot()+
  geom_density(aes(x = Data$page_values, col = y))
ggplot()+
  geom_bar(aes(x = Data$month, colour = as.factor(y)))
ggplot()+
  geom_bar(aes(x = Data$browser, colour = as.factor(y)))
#seeprate in high and low traffic months


```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
model1 = glm(purchase~.-1, data = Data)
model2 = stepAIC(model1, k = log(nrow(Data)))
model3 = glm(formula = purchase ~ product_related_duration + exit_rates + page_values + month + visitor_type + special_day + I(special_day^2)- 1, data = Data)
```


